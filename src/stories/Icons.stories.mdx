import { Meta, Story, ArgsTable, Canvas } from '@storybook/addon-docs'
import { AIcon } from '../components'
import icons, { DEPRECATED_ICONS } from '../components/icons'

<Meta
  title="Components/Icons"
  component={AIcon}
  argTypes={{
    size: {
      options: ['sm', 'md', 'lg', 'other'],
      control: 'radio'
    }
  }}
/>

export const toKebabCase = str => str.replace(/([a-z])([A-Z])/g, '$1-$2').toLowerCase()

export const Template = args => ({
  components: { AIcon },
  setup() {
    const getIconId = name => `${toKebabCase(name)}-${args.size}`
    return { args, icons, DEPRECATED_ICONS, getIconId }
  },
  template: `
  <div class="grid grid-cols-4">
    <div class="m-4 flex flex-col text-navy" v-for="(icon, name) in icons.${args.size}">
      <div class="flex items-center">
        <a-icon :size="args.size" :name="name" />
        <span class="ml-3 body-md">{{name}}</span>
        <span v-if="DEPRECATED_ICONS[args.size].includes(name)" class="text-error body-xs-600 mx-1">(deprecated)</span>
      </div>
      <code class="text-xs text-warsaw mt-1">{{getIconId(name)}}</code>
    </div>
  </div>
  `
})

# Icons

<ArgsTable of={AIcon} />

## Type-Safe Usage (Recommended)

Use the `icon` prop with the format `name-size` for type-safe icon selection. This ensures valid name+size combinations at compile time.

```html
<!-- Type-safe: invalid combinations will show TypeScript errors -->
<a-icon icon="folder-sm" />
<a-icon icon="check-md" />
<a-icon icon="burger-lg" />
<a-icon icon="add-other" />
```

The `icon` prop accepts kebab-case identifiers like:

- `search-sm`, `folder-sm`, `check-sm` (small icons)
- `search-md`, `folder-md`, `check-md` (medium icons)
- `search-lg`, `burger-lg`, `pencil-lg` (large icons)
- `add-other`, `warning-other` (other size icons)

**TypeScript will catch invalid combinations:**

```typescript
<a-icon icon="check-other" />  // Error: 'check-other' is not assignable to IconIdentifier
<a-icon icon="burger-sm" />    // Error: 'burger-sm' is not assignable to IconIdentifier
```

## Legacy Usage (Deprecated)

The `name` and `size` props still work but are deprecated. They don't provide compile-time validation of valid combinations.

```html
<!-- Deprecated: use icon="folder-sm" instead -->
<a-icon size="sm" name="Folder" />
```

## Icons sm (16x16px)

```html
<a-icon icon="folder-sm" />
```

<Canvas>
  <Story name="small" args={{ size: 'sm' }}>
    {Template.bind({})}
  </Story>
</Canvas>

## Icons md (32x32px)

```html
<a-icon icon="folder-md" />
```

<Canvas>
  <Story name="medium" args={{ size: 'md' }}>
    {Template.bind({})}
  </Story>
</Canvas>

## Icons lg (40x40px)

```html
<a-icon icon="burger-lg" />
```

<Canvas>
  <Story name="large" args={{ size: 'lg' }}>
    {Template.bind({})}
  </Story>
</Canvas>

## Icons other (various sizes)

```html
<a-icon icon="add-other" />
```

<Canvas>
  <Story name="other" args={{ size: 'other' }}>
    {Template.bind({})}
  </Story>
</Canvas>

## Icon colors

The icons' `fill` or `stroke` attribute is set to `currentColor` so they will match the parent container's text color.

```html
<div class="text-error">
  <a-icon icon="info-md" />
  This is a red error message.
</div>
```

<Canvas>
  <Story name="change color">
    {() => ({
      components: { AIcon },
      template: `<div class="flex items-center text-error"><a-icon icon="warning-other"/>This is a red error message.</div>`
    })}
  </Story>
</Canvas>

## Troubleshooting

**Using TypeScript?** Use the `icon` prop for compile-time validation. Invalid combinations like `icon="check-other"` will show TypeScript errors.

**Not using TypeScript?** If you don't see the correct icon, double check the `icon` prop value. The format is `name-size` in kebab-case (e.g., `arrow-left-md`).

If the icon does not exist, an error will be printed to the console along with the list of all available icons in each size.
